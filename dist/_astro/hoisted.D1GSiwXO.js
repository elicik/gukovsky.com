import{S as R}from"./sweetalert2.Cs7ISwYJ.js";import"./hoisted.N2XxB48v.js";import"./_commonjsHelpers.Cpj98o6Y.js";let n,a,x,h,f,g,v,i,q,z=!1,m=!1,M=!1,E=!1,b=0;window.addEventListener("keypress",k);function k(e){b===5&&(e.which===13&&e.shiftKey?(E=!0,window.removeEventListener("keypress",k)):b=0),String.fromCharCode(e.which)==="xyzzy"[b]?b++:b=String.fromCharCode(e.which)==="x"?1:0}class O{constructor(){this.bomb=!1,this.surrounding=0,this.activated=!1,this.flagged=!1,this.hint=!1,this.deathBomb=!1,this.hover=!1}}const B={BEGINNER:{width:9,height:9,bombs:10,getHighscore:function(){return localStorage.getItem("minesweeper-highscore-beginner")},setHighscore:function(e){localStorage.setItem("minesweeper-highscore-beginner",e)}},INTERMEDIATE:{width:16,height:16,bombs:40,getHighscore:function(){return localStorage.getItem("minesweeper-highscore-intermediate")},setHighscore:function(e){localStorage.setItem("minesweeper-highscore-intermediate",e)}},EXPERT:{width:30,height:16,bombs:99,getHighscore:function(){return localStorage.getItem("minesweeper-highscore-expert")},setHighscore:function(e){localStorage.setItem("minesweeper-highscore-expert",e)}}};let u=B.INTERMEDIATE;function I(){n=u.width,a=u.height,x=u.bombs,h=!0,f=0,g=0,i=[],q=!0,clearInterval(v),Q(),G(),T(),J(),document.querySelector("#smiley").dataset.ooh=!1,document.querySelector("#smiley").dataset.dead=!1,document.querySelector("#smiley").dataset.win=!1}function G(){for(let e=0;e<n;e++){i[e]=[];for(let t=0;t<a;t++)i[e][t]=new O}for(let e=0;e<x;e++)C()}function T(){for(let e=0;e<n;e++)for(let t=0;t<a;t++){i[e][t].bomb&&(i[e][t].surrounding=null);let o=0;for(let r=Math.max(e-1,0);r<=Math.min(e+1,n-1);r++)for(let l=Math.max(t-1,0);l<=Math.min(t+1,a-1);l++)i[r][l].bomb&&o++;i[e][t].surrounding=o}}function C(){let e=!1;for(;!e;){let t=Math.floor(Math.random()*n),o=Math.floor(Math.random()*a);i[t][o].bomb||(i[t][o].bomb=!0,e=!0)}}function F(e,t){let o=i[e][t];!o.activated&&!o.flagged&&(o.hint=!1,o.bomb?W(e,t):(o.activated=!0,o.surrounding===0&&A(e,t))),c(e,t),Y()&&X()}function A(e,t){for(let o=Math.max(e-1,0);o<=Math.min(e+1,n-1);o++)for(let r=Math.max(t-1,0);r<=Math.min(t+1,a-1);r++)F(o,r)}function P(){for(let e=0;e<n;e++)for(let t=0;t<a;t++){let o=i[e][t];o.bomb!==o.flagged&&(o.activated=!0,c(e,t))}}function U(){for(let e=0;e<n;e++)for(let t=0;t<a;t++){let o=i[e][t];o.bomb&&!o.flagged&&(o.flagged=!0,g++,c(e,t))}S()}function L(){for(let e=0;e<n;e++)for(let t=0;t<a;t++){let o=i[e][t];o.hover&&(o.hover=!1,c(e,t))}}function K(){for(let e=0;e<n;e++)for(let t=0;t<a;t++){let o=i[e][t];o.hint&&(o.hint=!1,c(e,t))}}function w(e,t){for(let o=Math.max(e-1,0);o<=Math.min(e+1,n-1);o++)for(let r=Math.max(t-1,0);r<=Math.min(t+1,a-1);r++){let l=i[o][r];l.hover=!0,c(o,r)}}function H(e,t){let o=i[e][t],r=0;for(let l=Math.max(e-1,0);l<=Math.min(e+1,n-1);l++)for(let s=Math.max(t-1,0);s<=Math.min(t+1,a-1);s++)i[l][s].flagged&&r++;o.surrounding===r&&A(e,t)}function W(e,t){h=!1,clearInterval(v);let o=i[e][t];o.deathBomb=!0,c(e,t),P(),document.querySelector("#smiley").dataset.dead=!0}function X(){h=!1,clearInterval(v),U(),document.querySelector("#smiley").dataset.win=!0,!E&&(u.getHighscore()===null||parseInt(u.getHighscore(),10)>f)&&(R.fire({title:"Congrats!",text:"You got a highscore of "+f+"!",icon:"success",timer:4e3}),u.setHighscore(f),document.querySelector("#highscore").innerHTML=u.getHighscore())}function Y(){for(let e=0;e<n;e++)for(let t=0;t<a;t++){let o=i[e][t];if(o.activated===o.bomb)return!1}return!0}function J(){let e=document.querySelector("#minesweeper");e.innerHTML="";for(let t=0;t<a;t++){let o=document.createElement("tr");for(let r=0;r<n;r++){let l=document.createElement("td");l.dataset.x=r,l.dataset.y=t,l.addEventListener("mouseover",_),l.addEventListener("mouseout",$),o.appendChild(l)}e.appendChild(o)}j(),S()}function Q(){let e=document.querySelector("#minesweeper");for(;e.firstChild;)e.removeChild(e.firstChild)}function c(e,t){let o=document.querySelector('#minesweeper td[data-x="'+e+'"][data-y="'+t+'"]'),r=i[e][t];o.dataset.bomb=r.bomb,o.dataset.surrounding=r.surrounding,o.dataset.activated=r.activated,o.dataset.flagged=r.flagged,o.dataset.hint=r.hint,o.dataset.deathBomb=r.deathBomb,o.dataset.hover=r.hover,r.activated&&r.surrounding>=1&&!r.bomb&&!r.flagged?o.innerHTML=r.surrounding:o.innerHTML=""}function j(){for(let e=0;e<n;e++)for(let t=0;t<a;t++)c(e,t)}function V(){f++,f>999&&clearInterval(v),document.querySelector("#clock").innerHTML=("00"+f).slice(-3)}function S(){let e=x-g,t=("00"+Math.abs(e)).slice(-3);e<0&&(t="-"+t.slice(1)),document.querySelector("#numBombs").innerHTML=t}function Z(e,t){let o=0;for(let r=Math.max(e-1,0);r<=Math.min(e+1,n-1);r++)for(let l=Math.max(t-1,0);l<=Math.min(t+1,a-1);l++)i[r][l].bomb?o++:i[r][l].bomb=!0;for(let r=0;r<o;r++)C();for(let r=Math.max(e-1,0);r<=Math.min(e+1,n-1);r++)for(let l=Math.max(t-1,0);l<=Math.min(t+1,a-1);l++)i[r][l].bomb=!1;T(),j(),document.querySelector("#clock").innerHTML="000",v=setInterval(V,1e3)}function _(e){if(!h)return;let t=e.target;t.addEventListener("mousedown",D),t.addEventListener("mouseup",N);let o=parseInt(t.dataset.x,10),r=parseInt(t.dataset.y,10),l=i[o][r],s=(e.buttons&1)===1,d=(e.buttons&2)===2;L(),s&&!d&&(l.activated&&!m?w(o,r):(l.hover=!0,c(o,r))),s&&d&&(m?w(o,r):(l.hover=!0,c(o,r))),E&&(document.querySelector("#xyzzy").style.background=l.bomb?"black":"white")}function $(e){if(!h)return;let t=e.target;t.removeEventListener("mousedown",D),t.removeEventListener("mouseup",N)}function D(e){if(!h)return;let t=e.target,o=parseInt(t.dataset.x,10),r=parseInt(t.dataset.y,10),l=i[o][r],s=(e.buttons&1)===1,d=(e.buttons&2)===2;L(),s&&!d?l.activated&&!m?w(o,r):(l.hover=!0,c(o,r)):s&&d?m?w(o,r):(l.hover=!0,c(o,r)):!s&&d&&(l.activated||(z?l.flagged?(l.flagged=!1,g--,S(),l.hint=!0):l.hint?l.hint=!1:(l.flagged=!0,g++,S()):(l.flagged=!l.flagged,g+=l.flagged?1:-1,S()),c(o,r))),s&&(document.querySelector("#smiley").dataset.ooh=!0)}function N(e){if(!h)return;let t=e.target,o=parseInt(t.dataset.x,10),r=parseInt(t.dataset.y,10),l=i[o][r],s=(e.buttons&1)===1,d=(e.buttons&2)===2;if(L(),d&&e.button===0||s&&e.button===2){l.activated&&m&&H(o,r),M=!0;return}M?M=!1:!s&&!d&&e.button===0&&(l.activated&&!m&&H(o,r),l.activated||(q&&(Z(o,r),q=!1),F(o,r))),s||(document.querySelector("#smiley").dataset.ooh=!1)}function y(){localStorage.setItem("minesweeper-size",document.querySelector("#size").value),localStorage.setItem("minesweeper-difficulty",document.querySelector("#difficulty").value),localStorage.setItem("minesweeper-oldfashioned",document.querySelector("#oldfashioned").checked),localStorage.setItem("minesweeper-hints",document.querySelector("#hints").checked)}function p(){document.body.id="size-"+localStorage.getItem("minesweeper-size"),u=B[localStorage.getItem("minesweeper-difficulty")],m=localStorage.getItem("minesweeper-oldfashioned")==="true",z=localStorage.getItem("minesweeper-hints")==="true",document.querySelector("#highscore").innerHTML=u.getHighscore()?u.getHighscore():"None yet!"}document.addEventListener("astro:page-load",function(e){e.target.title==="Minesweeper"&&(document.querySelector("#smiley").addEventListener("click",I),document.querySelector("#minesweeper").addEventListener("contextmenu",function(t){return t.preventDefault(),!1}),localStorage.getItem("minesweeper-size")!==null?(p(),document.querySelector("#size").value=localStorage.getItem("minesweeper-size"),document.querySelector("#difficulty").value=localStorage.getItem("minesweeper-difficulty"),document.querySelector("#oldfashioned").checked=localStorage.getItem("minesweeper-oldfashioned")==="true",document.querySelector("#hints").checked=localStorage.getItem("minesweeper-hints")==="true"):y(),document.querySelector("#size").addEventListener("change",function(t){y(),p()}),document.querySelector("#difficulty").addEventListener("change",function(t){y(),p(),I()}),document.querySelector("#oldfashioned").addEventListener("change",function(t){y(),p()}),document.querySelector("#hints").addEventListener("change",function(t){K(),y(),p()}),I())});
